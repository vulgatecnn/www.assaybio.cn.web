var e=(e,t,o)=>new Promise((a,l)=>{var n=e=>{try{s(o.next(e))}catch(t){l(t)}},r=e=>{try{s(o.throw(e))}catch(t){l(t)}},s=e=>e.done?a(e.value):Promise.resolve(e.value).then(n,r);s((o=o.apply(e,t)).next())});import{H as t,r as o,c as a,d as l,j as n,p as r,l as s,B as i,k as c,F as u,z as d,D as m,I as p,o as g,w as v,f as h,y,O as x,A as f,P as w,t as k,G as b,x as C}from"./vendor-vue-DfeTMTng.js";import{D,a as j,A as V,_ as B}from"./index-CbVirBU-.js";import{_}from"./Pagination.vue_vue_type_script_setup_true_lang-Cwe2tknW.js";import{d as M}from"./debounce-DWqR91Ur.js";import"./vendor-utils-ByYb-_ZS.js";const P=t("document",()=>{const t=o([]),l=o(null),n=o([]),r=o(!1),s=o(null),i=o({total:0,page:1,limit:10,totalPages:0}),c=a(()=>{const e={};return t.value.forEach(t=>{const o=t.category;e[o]||(e[o]=[]),e[o].push(t)}),e}),u=a(()=>{const e={};return t.value.forEach(t=>{const o=t.type;e[o]||(e[o]=[]),e[o].push(t)}),e}),d=a(()=>[...t.value].sort((e,t)=>new Date(t.publishDate).getTime()-new Date(e.publishDate).getTime()).slice(0,5));function m(o){return e(this,null,function*(){r.value=!0,s.value=null;try{const e=yield D.getDocuments({page:(null==o?void 0:o.page)||1,limit:(null==o?void 0:o.limit)||10,keyword:null==o?void 0:o.search,category:null==o?void 0:o.category});t.value=e.items,i.value={total:e.total,page:e.page,limit:e.limit,totalPages:e.totalPages}}catch(e){s.value=e instanceof Error?e.message:"获取文档列表失败"}finally{r.value=!1}})}return{documents:t,currentDocument:l,categories:n,isLoading:r,error:s,pagination:i,documentsByCategory:c,documentsByType:u,recentDocuments:d,fetchDocuments:m,fetchDocumentById:function(t){return e(this,null,function*(){r.value=!0,s.value=null;try{const e=yield D.getDocumentById(t);return l.value=e,e}catch(e){return s.value=e instanceof Error?e.message:"获取文档详情失败",null}finally{r.value=!1}})},fetchCategories:function(){return e(this,null,function*(){try{n.value=yield D.getDocumentCategories()}catch(e){s.value=e instanceof Error?e.message:"获取文档分类失败"}})},searchDocuments:function(t,o){return e(this,null,function*(){return m({search:t,category:o})})},downloadDocument:function(t){return e(this,null,function*(){if(!t.fileUrl)throw new Error("文档下载地址不存在");window.open(t.fileUrl,"_blank"),t.downloadCount+=1})},clearError:function(){s.value=null},resetCurrentDocument:function(){l.value=null}}}),z={class:"bg-white rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden group"},E={class:"relative h-32 bg-gradient-to-br from-primary-50 to-secondary-50 overflow-hidden flex items-center justify-center"},H={class:"text-primary-600"},U={key:0,class:"w-16 h-16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},I={key:1,class:"w-16 h-16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},T={key:2,class:"w-16 h-16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},L={key:3,class:"w-16 h-16",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},q={class:"absolute top-3 left-3"},A={class:"bg-primary-600 text-white text-xs font-medium px-2 py-1 rounded"},S={class:"p-6"},F={class:"mb-3"},G={class:"text-lg font-bold text-gray-900 group-hover:text-primary-600 transition-colors line-clamp-2"},N={class:"mb-3"},O={class:"inline-block bg-gray-100 text-gray-700 text-sm px-3 py-1 rounded-full"},J={class:"text-gray-600 text-sm mb-4 line-clamp-3"},K={key:0,class:"mb-4"},Q={class:"flex flex-wrap gap-2"},R={class:"flex items-center justify-between pt-4 border-t border-gray-100"},W={class:"flex items-center space-x-4 text-sm text-gray-500"},X={class:"flex items-center"},Y={class:"flex items-center"},Z=["disabled"],$=j(l({__name:"DocumentCard",props:{document:{}},emits:["download"],setup(e,{emit:t}){const o=e,a=t;function l(){o.document.fileUrl&&a("download",o.document)}return(e,t)=>{return r(),n("div",z,[s("div",E,[s("div",H,["manual"===e.document.type?(r(),n("svg",U,[...t[0]||(t[0]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.746 0 3.332.477 4.5 1.253v13C19.832 18.477 18.246 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"},null,-1)])])):"specification"===e.document.type?(r(),n("svg",I,[...t[1]||(t[1]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])])):"guide"===e.document.type?(r(),n("svg",T,[...t[2]||(t[2]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M19 11H5m14 0a2 2 0 012 2v6a2 2 0 01-2 2H5a2 2 0 01-2-2v-6a2 2 0 012-2m14 0V9a2 2 0 00-2-2M5 11V9a2 2 0 012-2m0 0V5a2 2 0 012-2h6a2 2 0 012 2v2M7 7h10"},null,-1)])])):(r(),n("svg",L,[...t[3]||(t[3]=[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"1",d:"M9 17v-2m3 2v-4m3 4v-6m2 10H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"},null,-1)])]))]),s("div",q,[s("span",A,i((a=e.document.type,{manual:"使用手册",specification:"技术规范",guide:"应用指南",report:"报告文档"}[a]||"文档")),1)])]),s("div",S,[s("div",F,[s("h3",G,i(e.document.title),1)]),s("div",N,[s("span",O,i(e.document.category),1)]),s("p",J,i(e.document.description),1),e.document.tags.length>0?(r(),n("div",K,[s("div",Q,[(r(!0),n(u,null,d(e.document.tags.slice(0,3),e=>(r(),n("span",{key:e,class:"inline-block bg-gray-100 text-gray-700 text-xs px-2 py-1 rounded"},i(e),1))),128))])])):c("",!0),s("div",R,[s("div",W,[s("div",X,[t[4]||(t[4]=s("svg",{class:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M8 7V3m8 4V3m-9 8h10M5 21h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1)),m(" "+i((o=e.document.publishDate,new Date(o).toLocaleDateString("zh-CN",{year:"numeric",month:"2-digit",day:"2-digit"}))),1)]),s("div",Y,[t[5]||(t[5]=s("svg",{class:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1)),m(" "+i(e.document.downloadCount)+" 次下载 ",1)])]),s("button",{onClick:l,disabled:!e.document.fileUrl,class:"flex items-center px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed"},[...t[6]||(t[6]=[s("svg",{class:"w-4 h-4 mr-1",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4"})],-1),m(" 下载 ",-1)])],8,Z)])])]);var o,a}}}),[["__scopeId","data-v-5f528f7f"]]),ee={class:"documents-page"},te={class:"py-8 bg-gray-50"},oe={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ae={class:"flex flex-col lg:flex-row gap-6"},le={class:"flex-1"},ne={class:"relative"},re={class:"lg:w-64"},se=["value"],ie={class:"py-16 bg-white"},ce={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},ue={key:0,class:"text-center py-12"},de={key:1,class:"text-center py-12"},me={class:"text-gray-600 mb-4"},pe={key:2},ge={class:"mb-8"},ve={class:"text-gray-600"},he={class:"font-semibold"},ye={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8"},xe={key:3,class:"text-center py-12"},fe=l({__name:"DocumentsView",setup(t){const a=C(),l=P(),{documents:D,categories:j,isLoading:z,error:E,pagination:H}=p(l),U=o(""),I=o(""),T=M(()=>{L()},500);function L(t=1){return e(this,null,function*(){yield l.fetchDocuments({page:t,limit:12,search:U.value,category:I.value})})}function q(e){L(e),window.scrollTo({top:0,behavior:"smooth"})}function A(){L(1)}function S(t){return e(this,null,function*(){try{yield l.downloadDocument(t)}catch(e){}})}return g(()=>e(this,null,function*(){!function(){const e=a.query;e.search&&(U.value=e.search),e.category&&(I.value=e.category)}(),yield Promise.all([l.fetchCategories(),L()])})),v(()=>a.query,e=>{e.search!==U.value&&(U.value=e.search||""),e.category!==I.value&&(I.value=e.category||""),L(1)}),(e,t)=>(r(),n("div",ee,[h(V),s("main",null,[t[10]||(t[10]=s("section",{class:"bg-primary-900 text-white py-20"},[s("div",{class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 text-center"},[s("h1",{class:"text-4xl md:text-5xl font-bold mb-6"},"技术文献"),s("p",{class:"text-xl text-primary-200 max-w-3xl mx-auto"}," 下载技术手册、规范文件和应用指南 ")])],-1)),s("section",te,[s("div",oe,[s("div",ae,[s("div",le,[s("div",ne,[y(s("input",{"onUpdate:modelValue":t[0]||(t[0]=e=>U.value=e),type:"text",placeholder:"搜索文档标题或描述...",class:"w-full px-4 py-3 pl-12 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",onInput:t[1]||(t[1]=(...e)=>f(T)&&f(T)(...e))},null,544),[[x,U.value]]),t[3]||(t[3]=s("div",{class:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none"},[s("svg",{class:"h-5 w-5 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})])],-1))])]),s("div",re,[y(s("select",{"onUpdate:modelValue":t[2]||(t[2]=e=>I.value=e),class:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",onChange:A},[t[4]||(t[4]=s("option",{value:""},"全部分类",-1)),(r(!0),n(u,null,d(f(j),e=>(r(),n("option",{key:e.name,value:e.name},i(e.name)+" ("+i(e.count)+") ",9,se))),128))],544),[[w,I.value]])])])])]),s("section",ie,[s("div",ce,[f(z)?(r(),n("div",ue,[...t[5]||(t[5]=[s("div",{class:"inline-flex items-center justify-center w-16 h-16 border-4 border-primary-200 border-t-primary-600 rounded-full animate-spin"},null,-1),s("p",{class:"mt-4 text-gray-600"},"正在加载文档...",-1)])])):f(E)?(r(),n("div",de,[t[6]||(t[6]=s("div",{class:"text-red-600 mb-4"},[s("svg",{class:"w-16 h-16 mx-auto",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor"},[s("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})])],-1)),s("p",me,i(f(E)),1),s("button",{onClick:L,class:"px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors"}," 重新加载 ")])):f(D).length>0?(r(),n("div",pe,[s("div",ge,[s("p",ve,[t[7]||(t[7]=m(" 找到 ",-1)),s("span",he,i(f(H).total),1),t[8]||(t[8]=m(" 个文档 ",-1))])]),s("div",ye,[(r(!0),n(u,null,d(f(D),e=>(r(),k($,{key:e.id,document:e,onDownload:S},null,8,["document"]))),128))]),f(H).totalPages>1?(r(),k(_,{key:0,"current-page":f(H).page,"total-pages":f(H).totalPages,total:f(H).total,onPageChange:q,class:"mt-12"},null,8,["current-page","total-pages","total"])):c("",!0)])):(r(),n("div",xe,[...t[9]||(t[9]=[b('<div class="text-gray-400 mb-4"><svg class="w-16 h-16 mx-auto" fill="none" viewBox="0 0 24 24" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"></path></svg></div><h3 class="text-lg font-semibold text-gray-900 mb-2">暂无文档</h3><p class="text-gray-600">没有找到符合条件的文档，请调整搜索条件</p>',3)])]))])])]),h(B)]))}});export{fe as default};
